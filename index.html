<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lou's List ğŸ›</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    :root {
      --bg: #1a1a2e;
      --card: #16213e;
      --card-hover: #1a2745;
      --accent: #e2b714;
      --accent-soft: rgba(226, 183, 20, 0.1);
      --text: #eee;
      --text-dim: #8892a4;
      --done: #4ecca3;
      --work: #4a9eff;
      --personal: #e87461;
      --creative: #c084fc;
      --relational: #f59e0b;
      --health: #10b981;
      --urgent: #ef4444;
      --border: rgba(255,255,255,0.06);
      --radius: 12px;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      padding: 0;
    }

    .header {
      padding: 32px 24px 20px;
      text-align: center;
      position: relative;
    }
    .header h1 { font-size: 24px; font-weight: 700; letter-spacing: -0.5px; }
    .header h1 span { color: var(--accent); }
    .header .subtitle { color: var(--text-dim); font-size: 13px; margin-top: 4px; }
    .header .mantra {
      color: var(--accent);
      font-size: 12px;
      font-style: italic;
      margin-top: 8px;
      opacity: 0.7;
    }

    .tabs {
      display: flex;
      gap: 4px;
      padding: 0 16px;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
    }
    .tabs::-webkit-scrollbar { display: none; }
    
    .tab {
      padding: 10px 16px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      white-space: nowrap;
      transition: all 0.2s;
      background: transparent;
      color: var(--text-dim);
      border: 1px solid transparent;
    }
    .tab:hover { color: var(--text); background: rgba(255,255,255,0.05); }
    .tab.active { background: var(--accent-soft); color: var(--accent); border-color: rgba(226,183,20,0.2); }
    .tab .count {
      display: inline-block;
      background: rgba(255,255,255,0.1);
      border-radius: 10px;
      padding: 1px 7px;
      font-size: 11px;
      margin-left: 4px;
    }
    .tab.active .count { background: rgba(226,183,20,0.2); }

    .content { padding: 20px 16px 100px; }

    .section-label {
      font-size: 11px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1.2px;
      color: var(--text-dim);
      margin: 24px 0 12px 4px;
    }
    .section-label:first-child { margin-top: 8px; }
    .section-label.urgent { color: var(--urgent); }

    .task-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 14px 16px;
      margin-bottom: 8px;
      display: flex;
      align-items: flex-start;
      gap: 12px;
      transition: all 0.2s;
    }
    .task-card:hover { background: var(--card-hover); transform: translateY(-1px); }
    .task-card.completed { opacity: 0.5; }
    .task-card.completed .task-text { text-decoration: line-through; }
    .task-card.urgent-card { border-color: rgba(239,68,68,0.3); background: rgba(239,68,68,0.05); }

    .checkbox {
      width: 22px;
      height: 22px;
      border-radius: 6px;
      border: 2px solid var(--text-dim);
      flex-shrink: 0;
      margin-top: 1px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
      cursor: pointer;
    }
    .checkbox:hover { border-color: var(--done); }
    .checkbox.checked {
      background: var(--done);
      border-color: var(--done);
    }
    .checkbox.checked::after {
      content: 'âœ“';
      color: var(--bg);
      font-size: 14px;
      font-weight: 700;
    }

    .task-body { flex: 1; min-width: 0; cursor: pointer; }
    .task-text { font-size: 14px; line-height: 1.4; }
    .task-due { font-size: 11px; color: var(--urgent); margin-top: 4px; font-weight: 600; }
    
    .task-meta {
      display: flex;
      gap: 6px;
      margin-top: 6px;
      flex-wrap: wrap;
      align-items: center;
    }
    .tag {
      font-size: 10px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.8px;
      padding: 2px 8px;
      border-radius: 6px;
    }
    .tag.work { background: rgba(74,158,255,0.15); color: var(--work); }
    .tag.personal { background: rgba(232,116,97,0.15); color: var(--personal); }
    .tag.creative { background: rgba(192,132,252,0.15); color: var(--creative); }
    .tag.relational { background: rgba(245,158,11,0.15); color: var(--relational); }
    .tag.health { background: rgba(16,185,129,0.15); color: var(--health); }

    .edit-btn {
      font-size: 11px;
      color: var(--text-dim);
      background: none;
      border: none;
      cursor: pointer;
      padding: 2px 6px;
      border-radius: 4px;
      opacity: 0;
      transition: all 0.2s;
    }
    .task-card:hover .edit-btn { opacity: 1; }
    .edit-btn:hover { background: rgba(255,255,255,0.1); color: var(--text); }

    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: var(--text-dim);
    }
    .empty-state .emoji { font-size: 48px; margin-bottom: 12px; }
    .empty-state p { font-size: 14px; line-height: 1.6; }

    .focus-banner {
      background: linear-gradient(135deg, rgba(226,183,20,0.08), rgba(78,204,163,0.08));
      border: 1px solid rgba(226,183,20,0.15);
      border-radius: var(--radius);
      padding: 16px;
      margin-bottom: 20px;
      text-align: center;
    }
    .focus-banner .week { font-size: 12px; color: var(--accent); font-weight: 600; text-transform: uppercase; letter-spacing: 1px; }
    .focus-banner .msg { font-size: 13px; color: var(--text-dim); margin-top: 4px; }

    .someday-note {
      background: rgba(255,255,255,0.03);
      border-radius: var(--radius);
      padding: 16px;
      margin-bottom: 20px;
      text-align: center;
      border: 1px dashed rgba(255,255,255,0.08);
    }
    .someday-note p { font-size: 13px; color: var(--text-dim); line-height: 1.5; }

    .done-card {
      background: rgba(78,204,163,0.05);
      border-color: rgba(78,204,163,0.1);
    }

    .fab {
      position: fixed;
      bottom: 24px;
      right: 24px;
      width: 56px;
      height: 56px;
      border-radius: 16px;
      background: var(--accent);
      color: var(--bg);
      font-size: 28px;
      font-weight: 300;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 20px rgba(226,183,20,0.3);
      transition: transform 0.2s;
    }
    .fab:hover { transform: scale(1.05); }

    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      backdrop-filter: blur(4px);
      display: none;
      align-items: flex-end;
      justify-content: center;
      z-index: 100;
    }
    .modal-overlay.show { display: flex; }

    .modal {
      background: var(--card);
      border-radius: 20px 20px 0 0;
      padding: 24px;
      width: 100%;
      max-width: 500px;
      max-height: 80vh;
      overflow-y: auto;
    }
    .modal h3 { font-size: 16px; margin-bottom: 16px; }
    
    .modal label {
      display: block;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.8px;
      color: var(--text-dim);
      margin-bottom: 6px;
      margin-top: 12px;
    }
    .modal label:first-of-type { margin-top: 0; }
    
    .modal input, .modal select {
      width: 100%;
      padding: 12px 14px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: var(--bg);
      color: var(--text);
      font-size: 14px;
      outline: none;
    }
    .modal input:focus, .modal select:focus { border-color: var(--accent); }
    
    .modal-row { display: flex; gap: 8px; margin-top: 12px; }
    .modal-row > * { flex: 1; }
    .modal-row label { margin-top: 0; }
    .modal-col { display: flex; flex-direction: column; }
    
    .modal .btn {
      width: 100%;
      padding: 14px;
      border-radius: 12px;
      border: none;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 16px;
    }
    .btn-primary { background: var(--accent); color: var(--bg); }
    .btn-secondary { background: rgba(255,255,255,0.05); color: var(--text-dim); margin-top: 8px; }
    .btn-danger { background: rgba(239,68,68,0.15); color: var(--urgent); margin-top: 8px; }

    .checkbox-row {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 12px;
    }
    .checkbox-row input[type="checkbox"] {
      width: 18px;
      height: 18px;
      accent-color: var(--accent);
    }
    .checkbox-row span { font-size: 13px; color: var(--text-dim); }

    @media (min-width: 600px) {
      .header { padding: 40px 24px 24px; }
      .header h1 { font-size: 28px; }
      .tabs { justify-content: center; }
      .content { max-width: 560px; margin: 0 auto; }
      .modal { border-radius: 20px; margin: auto; }
    }
  </style>
</head>
<body>

<div class="header">
  <h1>ğŸ› <span>Lou's List</span></h1>
  <div class="subtitle">Tell Lou. He's got it.</div>
  <div class="mantra">enjoy the river ğŸŒŠ</div>
</div>

<div class="tabs" id="tabs">
  <div class="tab active" data-tab="focus">ğŸ¯ Focus <span class="count" id="count-focus">0</span></div>
  <div class="tab" data-tab="active">ğŸ“‹ Active <span class="count" id="count-active">0</span></div>
  <div class="tab" data-tab="growing">ğŸŒ± Growing <span class="count" id="count-growing">0</span></div>
  <div class="tab" data-tab="someday">ğŸ”ï¸ Someday</div>
  <div class="tab" data-tab="done">âœ… Done</div>
</div>

<div class="content" id="content"></div>

<button class="fab" onclick="openAddModal()">+</button>

<!-- Add Modal -->
<div class="modal-overlay" id="addModal">
  <div class="modal">
    <h3>Add a task</h3>
    <label>Task</label>
    <input type="text" id="addTaskInput" placeholder="What needs doing?">
    <div class="modal-row">
      <div class="modal-col">
        <label>Category</label>
        <select id="addTaskCategory">
          <option value="work">ğŸ’¼ Work</option>
          <option value="personal">ğŸ§˜ Personal</option>
          <option value="health">ğŸ’š Health</option>
          <option value="creative">ğŸ¨ Creative</option>
          <option value="relational">ğŸ’› Relational</option>
        </select>
      </div>
      <div class="modal-col">
        <label>List</label>
        <select id="addTaskZone">
          <option value="focus">ğŸ¯ This Week</option>
          <option value="active">ğŸ“‹ Active</option>
          <option value="growing">ğŸŒ± Growing</option>
          <option value="someday">ğŸ”ï¸ Someday</option>
        </select>
      </div>
    </div>
    <div class="modal-row">
      <div class="modal-col">
        <label>Due (optional)</label>
        <input type="text" id="addTaskDue" placeholder="e.g. Mon 2/10, TODAY">
      </div>
    </div>
    <div class="checkbox-row">
      <input type="checkbox" id="addTaskUrgent">
      <span>ğŸ”¥ Mark as time-sensitive</span>
    </div>
    <button class="btn btn-primary" onclick="addTask()">Add Task</button>
    <button class="btn btn-secondary" onclick="closeAddModal()">Cancel</button>
  </div>
</div>

<!-- Edit Modal -->
<div class="modal-overlay" id="editModal">
  <div class="modal">
    <h3>Edit task</h3>
    <input type="hidden" id="editTaskId">
    <label>Task</label>
    <input type="text" id="editTaskInput" placeholder="What needs doing?">
    <div class="modal-row">
      <div class="modal-col">
        <label>Category</label>
        <select id="editTaskCategory">
          <option value="work">ğŸ’¼ Work</option>
          <option value="personal">ğŸ§˜ Personal</option>
          <option value="health">ğŸ’š Health</option>
          <option value="creative">ğŸ¨ Creative</option>
          <option value="relational">ğŸ’› Relational</option>
        </select>
      </div>
      <div class="modal-col">
        <label>List</label>
        <select id="editTaskZone">
          <option value="focus">ğŸ¯ This Week</option>
          <option value="active">ğŸ“‹ Active</option>
          <option value="growing">ğŸŒ± Growing</option>
          <option value="someday">ğŸ”ï¸ Someday</option>
        </select>
      </div>
    </div>
    <div class="modal-row">
      <div class="modal-col">
        <label>Due (optional)</label>
        <input type="text" id="editTaskDue" placeholder="e.g. Mon 2/10, TODAY">
      </div>
    </div>
    <div class="checkbox-row">
      <input type="checkbox" id="editTaskUrgent">
      <span>ğŸ”¥ Mark as time-sensitive</span>
    </div>
    <button class="btn btn-primary" onclick="saveEdit()">Save Changes</button>
    <button class="btn btn-secondary" onclick="closeEditModal()">Cancel</button>
    <button class="btn btn-danger" onclick="deleteTask()">Delete Task</button>
  </div>
</div>

<script>
const STORAGE_KEY = 'lou-list-tasks';
const DATA_VERSION = 5;

const SERVER_TASKS = [
  // This Week - Urgent (Camping Fri 2/14)
  { id: 100, text: "Order cold weather gear for camping", cat: "personal", zone: "focus", done: false, created: "2026-02-08", due: "Tue 2/11", urgent: true },
  { id: 101, text: "Organize camping meals", cat: "personal", zone: "focus", done: false, created: "2026-02-08", due: "Wed 2/12", urgent: true },
  // This Week - Health
  { id: 102, text: "Take prescription", cat: "health", zone: "focus", done: false, created: "2026-02-08", due: "TODAY", urgent: true },
  { id: 103, text: "Order prescription refill", cat: "health", zone: "focus", done: false, created: "2026-02-08", due: "TODAY", urgent: true },
  { id: 104, text: "Decide on health insurance", cat: "health", zone: "focus", done: false, created: "2026-02-08" },
  // This Week - Work
  { id: 105, text: "Paid ads initiative prep â€” 45-60 min brainstorm before Monday", cat: "work", zone: "focus", done: false, created: "2026-02-08" },
  // Active
  { id: 1, text: "Meet with Arjun re: responsibility handoff", cat: "work", zone: "active", done: false, created: "2026-02-04" },
  { id: 2, text: "Continue Rosebud onboarding & learning systems", cat: "work", zone: "active", done: false, created: "2026-02-04" },
  { id: 3, text: "Print out QR code for tea balcony", cat: "personal", zone: "active", done: false, created: "2026-02-11" },
  { id: 4, text: "Finance day with Daphne", cat: "relational", zone: "active", done: false, created: "2026-02-11" },
  { id: 5, text: "Schedule summer trip planning day with Daphne", cat: "relational", zone: "active", done: false, created: "2026-02-11" },
  // Growing
  { id: 10, text: "Build personal brand as part of Rosebud role", cat: "work", zone: "growing", done: false, created: "2026-02-04" },
  { id: 11, text: "Develop content creation skills (video, animation, storytelling)", cat: "creative", zone: "growing", done: false, created: "2026-02-04" },
  { id: 12, text: "Get a professional coach â€” ask about Q1 instead of Q2", cat: "personal", zone: "growing", done: false, created: "2026-02-04" },
  { id: 13, text: "Finish vision board (Dr. Tara Swart framework)", cat: "personal", zone: "growing", done: false, created: "2026-02-04" },
  { id: 14, text: "Look into Edge Esmeralda 2026 â€” dates, cost, Daphne's appetite", cat: "personal", zone: "growing", done: false, created: "2026-02-04" },
  { id: 15, text: "Summer trip with Daphne â€” explore co-living situations", cat: "relational", zone: "growing", done: false, created: "2026-02-04" },
  { id: 16, text: "Build Venice community (bike club, Primal, pickup basketball)", cat: "relational", zone: "growing", done: false, created: "2026-02-04" },
  { id: 17, text: "Next Substack essay", cat: "creative", zone: "growing", done: false, created: "2026-02-04" },
  // Someday
  { id: 20, text: "Sustainable collective living community (the long-term dream)", cat: "personal", zone: "someday", done: false, created: "2026-02-04" },
  { id: 21, text: "Deeper consciousness / Telepathy Tapes rabbit hole", cat: "personal", zone: "someday", done: false, created: "2026-02-04" },
  { id: 22, text: "Start a pickup basketball group in Venice", cat: "relational", zone: "someday", done: false, created: "2026-02-04" },
  { id: 23, text: "Plan a deep listening session (like the redwoods)", cat: "creative", zone: "someday", done: false, created: "2026-02-04" },
  { id: 24, text: "Explore Nico's Agatha co-living directory", cat: "personal", zone: "someday", done: false, created: "2026-02-04" },
  { id: 25, text: "Car registration", cat: "personal", zone: "someday", done: false, created: "2026-02-05" },
];

function loadTasks() {
  const stored = JSON.parse(localStorage.getItem(STORAGE_KEY));
  const storedVersion = parseInt(localStorage.getItem('lou-list-version') || '0');
  if (!stored || storedVersion < DATA_VERSION) {
    const doneIds = new Set((stored || []).filter(t => t.done).map(t => t.id));
    const merged = SERVER_TASKS.map(t => ({...t, done: doneIds.has(t.id)}));
    const serverIds = new Set(SERVER_TASKS.map(t => t.id));
    const localOnly = (stored || []).filter(t => !serverIds.has(t.id));
    const tasks = [...merged, ...localOnly];
    localStorage.setItem(STORAGE_KEY, JSON.stringify(tasks));
    localStorage.setItem('lou-list-version', String(DATA_VERSION));
    return tasks;
  }
  return stored;
}

let tasks = loadTasks();
let currentTab = 'focus';

function save() {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(tasks));
}

function updateCounts() {
  document.getElementById('count-focus').textContent = tasks.filter(t => t.zone === 'focus' && !t.done).length;
  document.getElementById('count-active').textContent = tasks.filter(t => t.zone === 'active' && !t.done).length;
  document.getElementById('count-growing').textContent = tasks.filter(t => t.zone === 'growing' && !t.done).length;
}

function toggleDone(id, e) {
  e.stopPropagation();
  const task = tasks.find(t => t.id === id);
  if (task) {
    task.done = !task.done;
    if (task.done) {
      task.completedAt = new Date().toISOString().split('T')[0];
      task.originalZone = task.zone;
      task.zone = 'done';
    } else {
      task.zone = task.originalZone || 'focus';
      delete task.completedAt;
    }
    save();
    render();
  }
}

function openEditModal(id) {
  const task = tasks.find(t => t.id === id);
  if (!task) return;
  
  document.getElementById('editTaskId').value = id;
  document.getElementById('editTaskInput').value = task.text;
  document.getElementById('editTaskCategory').value = task.cat;
  document.getElementById('editTaskZone').value = task.done ? (task.originalZone || 'focus') : task.zone;
  document.getElementById('editTaskDue').value = task.due || '';
  document.getElementById('editTaskUrgent').checked = task.urgent || false;
  
  document.getElementById('editModal').classList.add('show');
  document.getElementById('editTaskInput').focus();
}

function closeEditModal() {
  document.getElementById('editModal').classList.remove('show');
}

function saveEdit() {
  const id = parseInt(document.getElementById('editTaskId').value);
  const task = tasks.find(t => t.id === id);
  if (!task) return;
  
  task.text = document.getElementById('editTaskInput').value.trim();
  task.cat = document.getElementById('editTaskCategory').value;
  const newZone = document.getElementById('editTaskZone').value;
  if (!task.done) {
    task.zone = newZone;
  } else {
    task.originalZone = newZone;
  }
  task.due = document.getElementById('editTaskDue').value.trim() || undefined;
  task.urgent = document.getElementById('editTaskUrgent').checked;
  
  save();
  closeEditModal();
  render();
}

function deleteTask() {
  const id = parseInt(document.getElementById('editTaskId').value);
  if (confirm('Delete this task?')) {
    tasks = tasks.filter(t => t.id !== id);
    save();
    closeEditModal();
    render();
  }
}

function taskCard(task) {
  const urgentClass = task.urgent && !task.done ? 'urgent-card' : '';
  const dueHtml = task.due && !task.done ? `<div class="task-due">â° ${task.due}</div>` : '';
  return `
    <div class="task-card ${task.done ? 'completed done-card' : ''} ${urgentClass}">
      <div class="checkbox ${task.done ? 'checked' : ''}" onclick="toggleDone(${task.id}, event)"></div>
      <div class="task-body" onclick="openEditModal(${task.id})">
        <div class="task-text">${task.text}</div>
        ${dueHtml}
        <div class="task-meta">
          <span class="tag ${task.cat}">${task.cat}</span>
        </div>
      </div>
    </div>
  `;
}

function render() {
  updateCounts();
  const el = document.getElementById('content');
  const filtered = tasks.filter(t => t.zone === currentTab);
  
  if (currentTab === 'focus') {
    const focusTasks = filtered.filter(t => !t.done);
    const urgentTasks = focusTasks.filter(t => t.urgent);
    const normalTasks = focusTasks.filter(t => !t.urgent);
    
    let html = `
      <div class="focus-banner">
        <div class="week">Week of Feb 10, 2026</div>
        <div class="msg">Only what matters this week. Everything else is Lou's job.</div>
      </div>
    `;
    
    if (focusTasks.length === 0) {
      html += `
        <div class="empty-state">
          <div class="emoji">ğŸŒŠ</div>
          <p>Nothing in focus this week.<br>Enjoy the river, or tell Lou what to add.</p>
        </div>
      `;
    } else {
      if (urgentTasks.length) {
        html += `<div class="section-label urgent">ğŸ”¥ Time-Sensitive</div>`;
        html += urgentTasks.map(taskCard).join('');
      }
      
      const cats = ['health', 'work', 'personal', 'creative', 'relational'];
      const catLabels = { work: 'ğŸ’¼ Work', personal: 'ğŸ§˜ Personal', creative: 'ğŸ¨ Creative', relational: 'ğŸ’› Relational', health: 'ğŸ’š Health' };
      cats.forEach(cat => {
        const catTasks = normalTasks.filter(t => t.cat === cat);
        if (catTasks.length) {
          html += `<div class="section-label">${catLabels[cat]}</div>`;
          html += catTasks.map(taskCard).join('');
        }
      });
    }
    el.innerHTML = html;

  } else if (currentTab === 'someday') {
    let html = `
      <div class="someday-note">
        <p>ğŸ”ï¸ No pressure. No guilt. Just parked here.<br>Review quarterly or when inspiration strikes.</p>
      </div>
    `;
    html += filtered.filter(t => !t.done).map(taskCard).join('');
    if (filtered.filter(t => !t.done).length === 0) {
      html += `<div class="empty-state"><div class="emoji">ğŸ”ï¸</div><p>Nothing parked yet. That's fine too.</p></div>`;
    }
    el.innerHTML = html;

  } else if (currentTab === 'done') {
    const doneTasks = tasks.filter(t => t.done);
    if (doneTasks.length === 0) {
      el.innerHTML = `<div class="empty-state"><div class="emoji">âœ¨</div><p>Completed tasks show up here.<br>You're just getting started!</p></div>`;
    } else {
      el.innerHTML = doneTasks.map(taskCard).join('');
    }

  } else {
    const cats = ['work', 'personal', 'health', 'creative', 'relational'];
    const catLabels = { work: 'ğŸ’¼ Work', personal: 'ğŸ§˜ Personal', creative: 'ğŸ¨ Creative', relational: 'ğŸ’› Relational', health: 'ğŸ’š Health' };
    const activeTasks = filtered.filter(t => !t.done);
    
    if (activeTasks.length === 0) {
      el.innerHTML = `<div class="empty-state"><div class="emoji">${currentTab === 'active' ? 'ğŸ“‹' : 'ğŸŒ±'}</div><p>Nothing here yet. Tell Lou when something comes up.</p></div>`;
    } else {
      let html = '';
      cats.forEach(cat => {
        const catTasks = activeTasks.filter(t => t.cat === cat);
        if (catTasks.length) {
          html += `<div class="section-label">${catLabels[cat]}</div>`;
          html += catTasks.map(taskCard).join('');
        }
      });
      el.innerHTML = html;
    }
  }
}

// Tabs
document.getElementById('tabs').addEventListener('click', (e) => {
  const tab = e.target.closest('.tab');
  if (!tab) return;
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  tab.classList.add('active');
  currentTab = tab.dataset.tab;
  render();
});

// Add Modal
function openAddModal() {
  document.getElementById('addModal').classList.add('show');
  document.getElementById('addTaskInput').value = '';
  document.getElementById('addTaskDue').value = '';
  document.getElementById('addTaskUrgent').checked = false;
  document.getElementById('addTaskInput').focus();
}
function closeAddModal() {
  document.getElementById('addModal').classList.remove('show');
}
function addTask() {
  const text = document.getElementById('addTaskInput').value.trim();
  if (!text) return;
  const cat = document.getElementById('addTaskCategory').value;
  const zone = document.getElementById('addTaskZone').value;
  const due = document.getElementById('addTaskDue').value.trim();
  const urgent = document.getElementById('addTaskUrgent').checked;
  
  tasks.push({
    id: Date.now(),
    text,
    cat,
    zone,
    done: false,
    created: new Date().toISOString().split('T')[0],
    due: due || undefined,
    urgent
  });
  save();
  closeAddModal();
  currentTab = zone;
  document.querySelectorAll('.tab').forEach(t => {
    t.classList.toggle('active', t.dataset.tab === zone);
  });
  render();
}

// Enter key in modals
document.getElementById('addTaskInput').addEventListener('keydown', (e) => {
  if (e.key === 'Enter') addTask();
});
document.getElementById('editTaskInput').addEventListener('keydown', (e) => {
  if (e.key === 'Enter') saveEdit();
});

// Click outside modal to close
document.getElementById('addModal').addEventListener('click', (e) => {
  if (e.target === e.currentTarget) closeAddModal();
});
document.getElementById('editModal').addEventListener('click', (e) => {
  if (e.target === e.currentTarget) closeEditModal();
});

// Initial render
render();
</script>
</body>
</html>
